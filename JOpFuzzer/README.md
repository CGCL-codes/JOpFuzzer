# Usage of JOpFuzzer
## Step 1: Enviroment Setup

1. **JVM Setup**

JOpFuzzer needs the debug build of JVM, so users should download the source code of JVM and specify the debug flag. Here, we take the OpenJDK11 as an example.
```
# git clone https://github.com/openjdk/jdk11u.git
# cd jdk11u
# bash configure --enable-debug
# make images
```
Besides, if users want to collect the coverage information, users should use the command
```
# bash configure --enable-debug --enable-native-coverage
```
2. **Coverage collection**

JOpFuzzer uses Gcov and Lcov to collect the JVM coverage information. 
```
# cd jdk11u
# lcov -c -i -d ./ -o init.info
... (execute JOpFuzzer)
# lcov -c -d ./ -o cover.info
# lcov -a init.info -a cover.info -o total.info
# lcov -e total.info /absolute/path/to/target/jdk/src/hotspot/* -o hotspot.info
# lcov -l hotspot.info
```


## Step 2: Run the Tool

JOpFuzzer is developed as a maven project, so to configure and run JOpFuzzer, you can import it directly into your IntelliJ IDEA workspace as a maven project.
Execute **MainEntry** under src/main where the arguments are set as shown below:
```
-jdkPath                the jdk under test (e.g., /Library/Java/JavaVirtualMachines/jdk-11.jdk/Contents/Home)
-regressionTestPath               the seed for learning correlation (e.g., ./compiler, the regression test for compiler)
-seedNumber             the number of tests generated by JavaFuzzer (e.g., 1000)
-mutationRound          the number of mutation round (e.g., 1000)
```
Note that we use spoon for java source code structure analysis, but there is a dependency conflict with the relevant code in **tbar**, and the package name where the conflict occurs is the same. So pre-generate the adapted **tbar** as JavaMutator.jar to avoid conflicts.
